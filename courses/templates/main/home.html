{% extends 'base.html' %}
{% load static %}

{% block override_style %}

{% endblock %}

{% block content %}
<main class="container py-4">

    <h1 class="mb-2">Curio</h1>
    <p class="lead mb-2">
        Descubre cursos online y rutas de aprendizaje personalizadas según tus intereses.
    </p>
    <p class="text-muted mb-3">
        Buscador inteligente y recomendaciones basadas en el contenido de cada curso.
    </p>

    <section class="search-hero py-4 text-center">
        <h2 class="h3 mb-3">¿Qué quieres aprender hoy?</h2>
        <form action="{% url 'all_courses' %}" method="get" class="search-form d-flex justify-content-center mb-2">
            <input name="q" aria-label="Buscar cursos" class="form-control form-control-lg search-input" placeholder="Buscar cursos, tecnologías, temas…" />
            <button class="btn btn-primary search-btn d-flex align-items-center justify-content-center" type="submit" aria-label="Buscar">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16" aria-hidden="true">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.242 1.372a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
                </svg>
            </button>
        </form>
        <div class="text-muted">Consulta cursos de multiples plataformas en un único lugar.</div>
        
        <div class="mt-2 small text-muted">
            Sugerencias:
            <a href="{% url 'all_courses' %}?q=python" class="text-decoration-none">python</a> ·
            <a href="{% url 'all_courses' %}?q=machine+learning+beginner" class="text-decoration-none">machine learning beginner</a> ·
            <a href="{% url 'all_courses' %}?q=supply+chain" class="text-decoration-none">supply chain</a>
        </div>
    </section>


    <section class="categories py-4">
        <h2 class="h5 mb-3">Explora por áreas de conocimiento</h2>
        <div class="pill-list">
            {% for cat in categories %}
                <a href="{% url 'all_courses' %}?category={{ cat.id }}" class="category-pill"><span class="pill-label">{{ cat.name }}</span> <span class="count">{{ cat.course_set.count }}</span></a>
            {% empty %}
                <div class="list-group-item">No hay categorías disponibles.</div>
            {% endfor %}
        </div>
    </section>
    
    {% if recommended_courses %}
    <section class="recommended py-4">
        <h2 class="h5 mb-3">Recomendados para ti</h2>
        <div class="row g-3">
            {% for item in recommended_courses %}
            <div class="col-12 col-sm-6 col-md-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-title mb-1">{{ item.course.title }}</h6>
                        <div class="mb-2 text-muted small">{{ item.course.platform.name }}{% if item.course.rating %} · ★ {{ item.course.rating|floatformat:1 }}{% endif %} <span class="ms-2 text-primary">Score: {{ item.score|floatformat:3 }}</span></div>
                        <p class="card-text text-truncate mb-3">{{ item.course.description|default_if_none:""|truncatechars:120 }}</p>
                        <div class="mt-auto d-flex gap-2">
                            <a href="{{ item.course.url }}" class="btn btn-sm btn-primary" target="_blank" rel="noopener">Ir al curso</a>
                            <a href="{% url 'course_detail' item.course.id %}" class="btn btn-sm btn-outline-secondary">Ver detalle</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</main>
{% endblock %}